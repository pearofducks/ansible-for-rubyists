#!/usr/bin/ruby
# WANT_JSON

require 'json'

# this is a bare minimum example of a 'facts' module that returns some variables into the ansible
# namespace. it is written to run in ruby 1.9 or greater.

args = JSON.parse(File.read ARGV[0])

begin
  a = args['a'].to_i
  b = args['b'].to_i
rescue
  # to raise an error, return failed=True and a msg string.

  print JSON.dump({
    failed: true,
    msg: 'failed to parse inputs x or y'
  })

  # the error code here is not so important, the JSON is!
  exit(1)
end

# we may also wish to return changed=True or changed=False
# if we were modifying system resources to support handlers and change tracking
# if the module decides to not run, it can also return skipped=True

result = {
  a: a,
  b: b,
  sum: a + b,
}

print JSON.dump(result)
